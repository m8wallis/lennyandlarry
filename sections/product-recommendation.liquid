<div class="product-recommendations"
     data-base-url="{{ routes.product_recommendations_url }}"
     data-product-id="{{ product.id }}"
     data-limit="4"
     data-section-id="{{ section.id }}">
  {%- if recommendations.products_count > 0 -%}
  <section class="section-default section-default--related">
    <div class="shell">
      <header class="section__head">
        <h4 class="section__title h4 h4--mobile-small">{{ 'products.product.related_title' | t }}</h4><!-- /.section__title -->
      </header><!-- /.section__head -->

      <div class="section__body">
        <div class="product-items product-items--primary js-slider-products-resize">
          {%- for _product in recommendations.products limit: 4 -%}
          {% render 'product-item' _product: _product, modifier: 'product-item--default product-items__item' %}
          {%- endfor -%}
        </div><!-- /.product-items -->
      </div><!-- /.section__body -->
    </div><!-- /.shell -->
  </section><!-- /.section-default -->
  {%- endif -%}
</div>


<script>
  jQuery( document ).ready( function( $ ) {
    var relatedInterval = window.setInterval(function(){
			console.log( 'checking' );
    if ( $( '#shopify-section-product-recommendation .product-items' ).length ) {
			console.log( 'checked' );
        var api = new Yotpo.API(yotpo);
        api.refreshWidgets();
      clearInterval(relatedInterval)
    }
  }, 20);
  } )
</script>